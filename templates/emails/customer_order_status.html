<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Order Status Update</title>
</head>
<body style="margin: 0; padding: 0; font-family: Arial, sans-serif; line-height: 1.6; color: #202254; background: #F0F0F1;">
    <table 
        role="presentation" 
        width="100%" 
        cellpadding="0" 
        cellspacing="0" 
        border="0" 
        style="max-width: 600px; margin: 0 auto; background: white;">
        <!-- Header -->
        <tr>
            <td 
                style="background: #5652E7; color: white; padding: 30px 20px; text-align: center;" 
                align="center">
                <h1 style="margin: 0; font-size: 28px; color: white;">
                    {% if order.status == 'accepted' %}Order Accepted! {% endif %}
                    {% if order.status == 'in_progress' %}Order In Progress! {% endif %}
                    {% if order.status == 'completed' %}Order Completed! {% endif %}
                    {% if order.status == 'declined' %}Order Update {% endif %}
                </h1>
            </td>
        </tr>
        
        <!-- Content -->
        <tr>
            <td style="padding: 30px;">
                <table 
                    role="presentation" 
                    width="100%" 
                    cellpadding="0" 
                    cellspacing="0" 
                    border="0" 
                    style="background: #FEB5FF; color: #202254; padding: 12px 15px; border-radius: 6px; margin-bottom: 20px;">
                    <tr>
                        <td align="center">
                            <strong>Order Reference: #{{ order.reference_id }}</strong>
                        </td>
                    </tr>
                </table>
                
                <p style="margin: 0 0 20px 0;">Hi <strong>{{ order.customer_name }}</strong>,</p>
                
                <!-- Image Status Note -->
                {% if order.images.exists %}
                    {% if order.status == 'in_progress' %}
                    <table role="presentation" width="100%" cellpadding="0" cellspacing="0" border="0" style="background: #9EECE2; padding: 12px; border-radius: 6px; margin-bottom: 20px;">
                        <tr>
                            <td align="center">
                                <span style="font-size: 14px; color: #202254;">
                                    <strong> Using Your Reference Images</strong><br/>
                                    I'm using your reference images to guide the creation process - they're super helpful!
                                </span>
                            </td>
                        </tr>
                    </table>
                    {% elif order.status == 'completed' %}
                    <table role="presentation" width="100%" cellpadding="0" cellspacing="0" border="0" style="background: #9EECE2; padding: 12px; border-radius: 6px; margin-bottom: 20px;">
                        <tr>
                            <td align="center">
                                <span style="font-size: 14px; color: #202254;">
                                    <strong> Reference Images Were Invaluable</strong><br/>
                                    Your reference images helped create the beautiful final design!
                                </span>
                            </td>
                        </tr>
                    </table>
                    {% elif order.status == 'accepted' %}
                    <table role="presentation" width="100%" cellpadding="0" cellspacing="0" border="0" style="background: #9EECE2; padding: 12px; border-radius: 6px; margin-bottom: 20px;">
                        <tr>
                            <td align="center">
                                <span style="font-size: 14px; color: #202254;">
                                    <strong>Great Reference Material</strong><br/>
                                    Your reference images give me a perfect starting point for your design!
                                </span>
                            </td>
                        </tr>
                    </table>
                    {% endif %}
                {% else %}
                    {% if order.status == 'accepted' or order.status == 'in_progress' %}
                    <table role="presentation" width="100%" cellpadding="0" cellspacing="0" border="0" style="background: #FEB5FF; padding: 12px; border-radius: 6px; margin-bottom: 20px;">
                        <tr>
                            <td align="center">
                                <span style="font-size: 14px; color: #202254;">
                                    <strong> Want to Send Reference Images?</strong><br/>
                                    It's not too late! Reference images help ensure I capture your vision perfectly.
                                </span>
                            </td>
                        </tr>
                    </table>
                    {% endif %}
                {% endif %}

                <!-- Status-specific messages -->
                {% if order.status == 'accepted' %}
                <p style="margin: 0 0 20px 0;">
                    Great news! Your custom rug order <strong style="color: #114C56;">has been accepted! $50 deposit via Zelle/Venmo required to secure your spot. Remaining balance due after rug completion.</strong>
                </p>
                
                <table 
                    role="presentation" 
                    width="100%" 
                    cellpadding="0" 
                    cellspacing="0" 
                    border="0" 
                    style="background: #9EECE2; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                    <tr>
                        <td>
                            <h2 style="color: #202254; margin: 0 0 15px 0; font-size: 20px;">Next Steps</h2>
                            <table 
                                role="presentation" 
                                width="100%" 
                                cellpadding="0" 
                                cellspacing="0" 
                                border="0">
                                <tr>
                                    <td style="padding: 8px 0 8px 25px; position: relative;">
                                        <span style="position: absolute; left: 0; color: #5652E7; font-weight: bold;">1</span>
                                        You'll receive a separate email with the quote and payment details
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px 0 8px 25px; position: relative;">
                                        <span style="position: absolute; left: 0; color: #5652E7; font-weight: bold;">2</span>
                                        Submit $50 deposit via Venmo or Zelle to secure your order spot
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px 0 8px 25px; position: relative;">
                                        <span style="position: absolute; left: 0; color: #5652E7; font-weight: bold;">3</span>
                                        I'll begin creating your rug once deposit is received!
                                    </td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px 0 8px 25px; position: relative;">
                                        <span style="position: absolute; left: 0; color: #5652E7; font-weight: bold;">4</span>
                                        You'll receive progress updates along the way
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                </table>
                {% endif %}
                
                {% if order.status == 'in_progress' %}
                <p style="margin: 0 0 20px 0;">
                    I'm happy to let you know that your custom rug order <strong style="color: #5652E7;">is now in progress! Your rug is being created. Balance payment will be requested when your rug is finished.</strong>
                </p>
                
                <table 
                    role="presentation" 
                    width="100%" 
                    cellpadding="0" 
                    cellspacing="0" 
                    border="0" 
                    style="background: #9EECE2; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                    <tr>
                        <td>
                            <h2 style="color: #202254; margin: 0 0 15px 0; font-size: 20px;">Current Status</h2>
                            <p style="margin: 0; color: #202254;">
                                Your rug is now in the creation phase. This process typically takes 
                                {% if order.timeline %}{{ order.timeline }}{% else %}2-3 weeks{% endif %} 
                                depending on complexity.
                            </p>
                            {% if order.admin_notes %}
                            <p style="margin: 15px 0 0 0; padding: 10px; background: rgba(255,255,255,0.3); border-radius: 4px;">
                                <strong>Update:</strong> {{ order.admin_notes }}
                            </p>
                            {% endif %}
                        </td>
                    </tr>
                </table>
                {% endif %}
                
                {% if order.status == 'completed' %}
                <p style="margin: 0 0 20px 0;">
                    Fantastic news! Your custom rug order <strong style="color: #114C56;">is completed! Your rug is ready. Please submit the remaining balance via Zelle/Venmo to initiate shipping.</strong>
                </p>
                
                <table 
                    role="presentation" 
                    width="100%" 
                    cellpadding="0" 
                    cellspacing="0" border="0" 
                    style="background: #FEB5FF; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                    <tr>
                        <td align="center">
                            <h2 style="color: #202254; margin: 0 0 15px 0; font-size: 20px;">Ready for Delivery!</h2>
                            <p style="margin: 0; color: #202254;">
                                Your unique creation is finished! Please submit the remaining balance to begin the shipping process.
                            </p>
                            {% if order.admin_notes %}
                            <p style="margin: 15px 0 0 0; padding: 10px; background: rgba(255,255,255,0.3); border-radius: 4px;">
                                <strong>Completion Notes:</strong> {{ order.admin_notes }}
                            </p>
                            {% endif %}
                        </td>
                    </tr>
                </table>
                {% endif %}

                {% if order.status == 'declined' %}
                <p style="margin: 0 0 20px 0;">
                    We regret to inform you that your custom rug order <strong style="color: #ff4444;">could not be accepted at this time.</strong>
                </p>
                
                <table 
                    role="presentation" 
                    width="100%" 
                    cellpadding="0" 
                    cellspacing="0" 
                    border="0" 
                    style="background: #FEB5FF; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                    <tr>
                        <td>
                            <p style="margin: 0; color: #202254;">
                                Thank you for your interest in our custom rug services. Unfortunately, we are unable to proceed with your order at this time.
                            </p>
                            {% if order.admin_notes %}
                            <p style="margin: 15px 0 0 0; padding: 10px; background: rgba(255,255,255,0.3); border-radius: 4px;">
                                <strong>Note:</strong> {{ order.admin_notes }}
                            </p>
                            {% endif %}
                        </td>
                    </tr>
                </table>
                {% endif %}
                
                <!-- Footer -->
                <table role="presentation" width="100%" cellpadding="0" cellspacing="0" border="0" style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
                    <tr>
                        <td align="center" style="color: #666; font-size: 14px;">
                            <p style="margin: 0 0 10px 0;">Thank you for choosing The Rugly Barnacle!</p>
                            <p style="margin: 0;">If you have any questions, please reply to this email.</p>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
    </table>
</body>
</html>